<UserControl x:Class="UnifiedUI.Views.BundlePanel"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             Background="{StaticResource PrimaryBackground}">
    
    <UserControl.Resources>
        <!-- Apply dark theme to ALL controls in this panel -->
        <Style TargetType="TextBox" BasedOn="{StaticResource ModernTextBox}"/>
        <Style TargetType="ComboBox" BasedOn="{StaticResource ModernComboBox}"/>
        <Style TargetType="Label" BasedOn="{StaticResource ModernLabel}"/>
        <Style TargetType="TextBlock">
            <Setter Property="Foreground" Value="{StaticResource PrimaryText}"/>
        </Style>
        <Style TargetType="Border" x:Key="SectionBorder">
            <Setter Property="Background" Value="{StaticResource SecondaryBackground}"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderColor}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="{StaticResource CornerRadiusMedium}"/>
            <Setter Property="Padding" Value="15"/>
            <Setter Property="Effect" Value="{StaticResource SubtleShadow}"/>
        </Style>
    </UserControl.Resources>
    
    <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
        <StackPanel MaxWidth="1000">
     
        <!-- Header Banner (MODERN DARK) -->
        <Border Background="{StaticResource ElevatedSurface}"
                BorderBrush="{StaticResource SuccessColor}"
                BorderThickness="0,0,0,3"
                CornerRadius="{StaticResource CornerRadiusMedium}" 
                Padding="20" 
                Margin="0,0,0,20"
                Effect="{StaticResource SubtleShadow}">
            <StackPanel>
                <TextBlock Text="Bundle Assembly Automation" 
                           FontSize="20" 
                           FontWeight="SemiBold" 
                           Foreground="{StaticResource PrimaryText}"/>
                <TextBlock Text="Complete heat exchanger bundle configuration and generation" 
                           FontSize="12" 
                           Foreground="{StaticResource SecondaryText}" 
                           Margin="0,5,0,0"/>
            </StackPanel>
        </Border>

        <!-- Quick Actions Bar (MODERN DARK) -->
        <Border Background="{StaticResource SecondaryBackground}" 
                BorderBrush="{StaticResource BorderColor}" 
                BorderThickness="1" 
                CornerRadius="{StaticResource CornerRadiusMedium}" 
                Padding="15" 
                Margin="0,0,0,20">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <Button x:Name="btnImportPrego" 
                            Content="Import Prego" 
                            Click="BtnImportPrego_Click"
                            Style="{StaticResource SuccessButton}"
                            MinWidth="120"/>
                    <Button x:Name="btnSaveConfig" 
                            Content="Save Config" 
                            Click="BtnSaveConfig_Click"
                            Style="{StaticResource PrimaryButton}"
                            MinWidth="120"/>
                    <Button x:Name="btnExport" 
                            Content="Export" 
                            Click="BtnExport_Click"
                            Style="{StaticResource WarningButton}"
                            MinWidth="100"/>
                </StackPanel>
                
                <StackPanel Grid.Column="2" Orientation="Horizontal">
                    <TextBlock Text="Template:" 
                               VerticalAlignment="Center" 
                               Margin="0,0,10,0" 
                               FontWeight="SemiBold"
                               Foreground="{StaticResource PrimaryText}"/>
                    <ComboBox x:Name="cmbTemplate" 
                              Width="300" 
                              Style="{StaticResource ModernComboBox}"
                              ItemsSource="{Binding DataContext.AvailableTemplates, RelativeSource={RelativeSource AncestorType=Window}}"
                              SelectedItem="{Binding DataContext.SelectedTemplate, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay}"
                              DisplayMemberPath="DisplayName">
                    </ComboBox>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Job Information Section (MODERN DARK) -->
        <Expander x:Name="expJobInfo" Header="JOB INFORMATION" IsExpanded="True" 
                  Margin="0,0,0,15">
            <Expander.HeaderTemplate>
                <DataTemplate>
                    <TextBlock Text="{Binding}" FontSize="14" FontWeight="SemiBold" Foreground="{StaticResource PrimaryAccent}" Margin="5"/>
                </DataTemplate>
            </Expander.HeaderTemplate>
            <Border Style="{StaticResource SectionBorder}">
          <Grid>
 <Grid.RowDefinitions>
     <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
   <RowDefinition Height="Auto"/>
     <RowDefinition Height="Auto"/>
         </Grid.RowDefinitions>
  <Grid.ColumnDefinitions>
              <ColumnDefinition Width="140"/>
     <ColumnDefinition Width="*"/>
    <ColumnDefinition Width="20"/>
         <ColumnDefinition Width="140"/>
            <ColumnDefinition Width="*"/>
     </Grid.ColumnDefinitions>

 <!-- Row 1 -->
     <TextBlock Grid.Row="0" Grid.Column="0" Text="Job Number: *" VerticalAlignment="Center" Foreground="#D32F2F" FontWeight="SemiBold"/>
 <TextBox x:Name="txtJobNumber" Grid.Row="0" Grid.Column="1" Height="32" Padding="8" Margin="0,5" FontSize="13" BorderBrush="{StaticResource PrimaryAccent}" BorderThickness="2"
     Text="{Binding DataContext.GlobalJobNumber, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
        <TextBlock Grid.Row="0" Grid.Column="3" Text="Bank:" VerticalAlignment="Center" FontWeight="SemiBold"/>
  <TextBox x:Name="txtBank" Grid.Row="0" Grid.Column="4" Height="32" Padding="8" Margin="0,5" FontSize="13" MaxLength="1"
           Text="{Binding DataContext.Bank, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
   
    <!-- Row 2 -->
      <TextBlock Grid.Row="1" Grid.Column="0" Text="Customer:" VerticalAlignment="Center" FontWeight="SemiBold"/>
       <TextBox x:Name="txtCustomer" Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="4" Height="32" Padding="8" Margin="0,5" FontSize="13"
       Text="{Binding DataContext.Customer, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
     
           <!-- Row 3 -->
  <TextBlock Grid.Row="2" Grid.Column="0" Text="Client:" VerticalAlignment="Center" FontWeight="SemiBold"/>
      <TextBox x:Name="txtClient" Grid.Row="2" Grid.Column="1" Height="32" Padding="8" Margin="0,5" FontSize="13"
            Text="{Binding DataContext.Client, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
 <TextBlock Grid.Row="2" Grid.Column="3" Text="Location:" VerticalAlignment="Center" FontWeight="SemiBold"/>
    <TextBox x:Name="txtLocation" Grid.Row="2" Grid.Column="4" Height="32" Padding="8" Margin="0,5" FontSize="13"
             Text="{Binding DataContext.Location, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
   
   <!-- Row 4 -->
    <TextBlock Grid.Row="3" Grid.Column="0" Text="Initials:" VerticalAlignment="Center" FontWeight="SemiBold"/>
     <TextBox x:Name="txtInitials" Grid.Row="3" Grid.Column="1" Height="32" Padding="8" Margin="0,5" FontSize="13" MaxLength="3"
           Text="{Binding DataContext.Initials, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
 <TextBlock Grid.Row="3" Grid.Column="3" Text="Titleblock:" VerticalAlignment="Center" FontWeight="SemiBold"/>
     <ComboBox x:Name="cmbTitleblock" Grid.Row="3" Grid.Column="4" Height="32" Margin="0,5"
               SelectedValue="{Binding DataContext.Titleblock, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay}"
               SelectedValuePath="Content">
         <ComboBoxItem Content="Hudson"/>
         <ComboBoxItem Content="Smithco"/>
     </ComboBox>
        </Grid>
      </Border>
       </Expander>

        <!-- Bundle Dimensions Section (MODERN DARK) -->
        <Expander x:Name="expBundleDims" Header="BUNDLE DIMENSIONS" IsExpanded="True" 
                  Margin="0,0,0,15">
            <Expander.HeaderTemplate>
                <DataTemplate>
                    <TextBlock Text="{Binding}" FontSize="14" FontWeight="SemiBold" Foreground="{StaticResource SuccessColor}" Margin="5"/>
                </DataTemplate>
            </Expander.HeaderTemplate>
            <Border Style="{StaticResource SectionBorder}">
<Grid>
      <Grid.RowDefinitions>
   <RowDefinition Height="Auto"/>
  <RowDefinition Height="Auto"/>
        <RowDefinition Height="Auto"/>
       <RowDefinition Height="Auto"/>
   </Grid.RowDefinitions>
<Grid.ColumnDefinitions>
   <ColumnDefinition Width="180"/>
    <ColumnDefinition Width="150"/>
  <ColumnDefinition Width="*"/>
      </Grid.ColumnDefinitions>
   
      <TextBlock Grid.Row="0" Grid.Column="0" Text="Bundle Width: *" VerticalAlignment="Center" FontWeight="Bold"/>
           <TextBox x:Name="txtBundleWidth" Grid.Row="0" Grid.Column="1" Height="34" Padding="8" Margin="0,5" FontSize="14" BorderBrush="{StaticResource SuccessColor}" BorderThickness="2"
Text="{Binding DataContext.BundleWidth, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
     <TextBlock Grid.Row="0" Grid.Column="2" Text="inches" VerticalAlignment="Center" Margin="10,0" Foreground="{StaticResource SecondaryText}"/>
    
<TextBlock Grid.Row="1" Grid.Column="0" Text="Side Frame THK:" VerticalAlignment="Center" FontWeight="SemiBold"/>
             <ComboBox x:Name="cmbSideFrameTHK" Grid.Row="1" Grid.Column="1" Height="34" Margin="0,5"
                       SelectedValue="{Binding DataContext.SideFrameThickness, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                       SelectedValuePath="Content">
                 <ComboBoxItem Content="0.250"/>
                 <ComboBoxItem Content="0.375"/>
                 <ComboBoxItem Content="0.500"/>
             </ComboBox>
          <TextBlock Grid.Row="1" Grid.Column="2" Text="inches" VerticalAlignment="Center" Margin="10,0" Foreground="{StaticResource SecondaryText}"/>

      <TextBlock Grid.Row="2" Grid.Column="0" Text="Side Frame Depth:" VerticalAlignment="Center" FontWeight="SemiBold"/>
  <TextBox x:Name="txtSideFrameDepth" Grid.Row="2" Grid.Column="1" Height="34" Padding="8" Margin="0,5"
        Text="{Binding DataContext.SideFrameDepth, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
     <TextBlock Grid.Row="2" Grid.Column="2" Text="inches" VerticalAlignment="Center" Margin="10,0" Foreground="{StaticResource SecondaryText}"/>
        
         <CheckBox x:Name="chkHeadersOutside" Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="2" 
         Content="Headers Outside Frame" Margin="0,10,0,0" FontWeight="SemiBold"
        IsChecked="{Binding DataContext.HeadersOutsideFrame, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay}"/>
  </Grid>
        </Border>
          </Expander>

       <!-- Tube Configuration Section -->
        <Expander x:Name="expTubeConfig" Header="TUBE CONFIGURATION" IsExpanded="True" 
Margin="0,0,0,15" BorderBrush="{StaticResource WarningColor}" BorderThickness="2">
     <Expander.HeaderTemplate>
        <DataTemplate>
            <TextBlock Text="TUBE CONFIGURATION" FontSize="14" FontWeight="Bold" Foreground="#F57C00" Margin="5"/>
      </DataTemplate>
     </Expander.HeaderTemplate>
            <Border Style="{StaticResource SectionBorder}">
          <StackPanel>
  <!-- Basic Tube Properties -->
  <TextBlock Text="Tube Specifications" FontWeight="Bold" FontSize="13" Margin="0,0,0,10" Foreground="#E65100"/>
      <Grid>
  <Grid.RowDefinitions>
       <RowDefinition Height="Auto"/>
               <RowDefinition Height="Auto"/>
    <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
                 </Grid.RowDefinitions>
   <Grid.ColumnDefinitions>
        <ColumnDefinition Width="180"/>
          <ColumnDefinition Width="150"/>
  <ColumnDefinition Width="60"/>
  </Grid.ColumnDefinitions>
      
     <TextBlock Grid.Row="0" Grid.Column="0" Text="Tube Length:" VerticalAlignment="Center" FontWeight="SemiBold"/>
  <TextBox x:Name="txtTubeLength" Grid.Row="0" Grid.Column="1" Height="32" Padding="8" Margin="0,5"
           Text="{Binding DataContext.TubeLength, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
    <TextBlock Grid.Row="0" Grid.Column="2" Text="inches" VerticalAlignment="Center" Margin="10,0" Foreground="{StaticResource SecondaryText}"/>
       
            <TextBlock Grid.Row="1" Grid.Column="0" Text="Tube Projection:" VerticalAlignment="Center" FontWeight="SemiBold"/>
      <TextBox x:Name="txtTubeProjection" Grid.Row="1" Grid.Column="1" Height="32" Padding="8" Margin="0,5"
        Text="{Binding DataContext.TubeProjection, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
       <TextBlock Grid.Row="1" Grid.Column="2" Text="inches" VerticalAlignment="Center" Margin="10,0" Foreground="{StaticResource SecondaryText}"/>
    
     <TextBlock Grid.Row="2" Grid.Column="0" Text="Tube OD:" VerticalAlignment="Center" FontWeight="SemiBold"/>
   <TextBox x:Name="txtTubeOD" Grid.Row="2" Grid.Column="1" Height="32" Padding="8" Margin="0,5"
        Text="{Binding DataContext.TubeOD, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
   <TextBlock Grid.Row="2" Grid.Column="2" Text="inches" VerticalAlignment="Center" Margin="10,0" Foreground="{StaticResource SecondaryText}"/>
     
<TextBlock Grid.Row="3" Grid.Column="0" Text="Tube Wall THK:" VerticalAlignment="Center" FontWeight="SemiBold"/>
  <ComboBox x:Name="cmbTubeWallTHK" Grid.Row="3" Grid.Column="1" Height="32" Margin="0,5"
 Text="{Binding DataContext.TubeWallTHK, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
        <ComboBoxItem Content="0.035"/>
  <ComboBoxItem Content="0.049"/>
      <ComboBoxItem Content="0.065"/>
        </ComboBox>
      <TextBlock Grid.Row="3" Grid.Column="2" Text="inches" VerticalAlignment="Center" Margin="10,0" Foreground="{StaticResource SecondaryText}"/>
        
   <TextBlock Grid.Row="4" Grid.Column="0" Text="Fin OD:" VerticalAlignment="Center" FontWeight="SemiBold"/>
     <TextBox x:Name="txtFinOD" Grid.Row="4" Grid.Column="1" Height="32" Padding="8" Margin="0,5"
        Text="{Binding DataContext.FinOD, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
          <TextBlock Grid.Row="4" Grid.Column="2" Text="inches" VerticalAlignment="Center" Margin="10,0" Foreground="{StaticResource SecondaryText}"/>
            </Grid>
 
     <Separator Margin="0,15"/>
         
       <!-- Tube Layout -->
         <TextBlock Text="Tube Layout" FontWeight="Bold" FontSize="13" Margin="0,0,0,10" Foreground="#E65100"/>
   <Grid>
        <Grid.RowDefinitions>
     <RowDefinition Height="Auto"/>
   <RowDefinition Height="Auto"/>
        <RowDefinition Height="Auto"/>
 <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
         <ColumnDefinition Width="180"/>
  <ColumnDefinition Width="150"/>
    <ColumnDefinition Width="60"/>
   <ColumnDefinition Width="*"/>
      </Grid.ColumnDefinitions>
 
 <TextBlock Grid.Row="0" Grid.Column="0" Text="Row 1 Left Count:" VerticalAlignment="Center" FontWeight="SemiBold"/>
     <TextBox x:Name="txtRow1Left" Grid.Row="0" Grid.Column="1" Height="32" Padding="8" Margin="0,5"
                Text="{Binding DataContext.TubeRow1Left, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
    <TextBlock Grid.Row="0" Grid.Column="2" Text="tubes" VerticalAlignment="Center" Margin="10,0" Foreground="{StaticResource SecondaryText}"/>
          
         <TextBlock Grid.Row="1" Grid.Column="0" Text="Row 2 Left Count:" VerticalAlignment="Center" FontWeight="SemiBold"/>
   <TextBox x:Name="txtRow2Left" Grid.Row="1" Grid.Column="1" Height="32" Padding="8" Margin="0,5"
  Text="{Binding DataContext.TubeRow2Left, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
         <TextBlock Grid.Row="1" Grid.Column="2" Text="tubes" VerticalAlignment="Center" Margin="10,0" Foreground="{StaticResource SecondaryText}"/>
  
 <TextBlock Grid.Row="2" Grid.Column="0" Text="Horizontal Pitch:" VerticalAlignment="Center" FontWeight="SemiBold"/>
  <TextBox x:Name="txtHorizPitch" Grid.Row="2" Grid.Column="1" Height="32" Padding="8" Margin="0,5"
        Text="{Binding DataContext.HorizontalPitch, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
     <TextBlock Grid.Row="2" Grid.Column="2" Text="inches" VerticalAlignment="Center" Margin="10,0" Foreground="{StaticResource SecondaryText}"/>
       
  <TextBlock Grid.Row="3" Grid.Column="0" Text="Total Quantity:" VerticalAlignment="Center" FontWeight="Bold" Foreground="#1976D2"/>
     <TextBlock x:Name="txtTubeQuantity" Grid.Row="3" Grid.Column="1" Height="32" Padding="8" Margin="0,5"
      Background="{StaticResource ElevatedSurface}" FontWeight="Bold" FontSize="14" VerticalAlignment="Center" TextAlignment="Center"
     Text="{Binding DataContext.TubeQuantity, RelativeSource={RelativeSource AncestorType=Window}, Mode=OneWay}"/>
     </Grid>
      
       <Separator Margin="0,15"/>
    
    <!-- Fin Strip Back -->
    <TextBlock Text="Fin Configuration" FontWeight="Bold" FontSize="13" Margin="0,0,0,10" Foreground="#E65100"/>
            <Grid>
     <Grid.ColumnDefinitions>
          <ColumnDefinition Width="180"/>
               <ColumnDefinition Width="150"/>
  <ColumnDefinition Width="60"/>
</Grid.ColumnDefinitions>
   <Grid.RowDefinitions>
   <RowDefinition Height="Auto"/>
   <RowDefinition Height="Auto"/>
   </Grid.RowDefinitions>
      
        <TextBlock Grid.Row="0" Grid.Column="0" Text="Front Fin Strip Back:" VerticalAlignment="Center" FontWeight="SemiBold"/>
        <TextBox x:Name="txtFrontFinStrip" Grid.Row="0" Grid.Column="1" Height="32" Padding="8" Margin="0,5"
        Text="{Binding DataContext.FrontFinStripBack, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
       <TextBlock Grid.Row="0" Grid.Column="2" Text="inches" VerticalAlignment="Center" Margin="10,0" Foreground="{StaticResource SecondaryText}"/>
        
   <TextBlock Grid.Row="1" Grid.Column="0" Text="Rear Fin Strip Back:" VerticalAlignment="Center" FontWeight="SemiBold"/>
         <TextBox x:Name="txtRearFinStrip" Grid.Row="1" Grid.Column="1" Height="32" Padding="8" Margin="0,5"
           Text="{Binding DataContext.RearFinStripBack, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
    <TextBlock Grid.Row="1" Grid.Column="2" Text="inches" VerticalAlignment="Center" Margin="10,0" Foreground="{StaticResource SecondaryText}"/>
   </Grid>
 </StackPanel>
   </Border>
            </Expander>

            <!-- Tube Supports Section -->
   <Expander x:Name="expTubeSupports" Header="TUBE SUPPORTS" IsExpanded="False" 
      Margin="0,0,0,15" BorderBrush="#9C27B0" BorderThickness="2">
   <Expander.HeaderTemplate>
       <DataTemplate>
       <TextBlock Text="{Binding}" FontSize="14" FontWeight="Bold" Foreground="#7B1FA2" Margin="5"/>
</DataTemplate>
       </Expander.HeaderTemplate>
            <Border Style="{StaticResource SectionBorder}">
      <Grid>
  <Grid.RowDefinitions>
     <RowDefinition Height="Auto"/>
     <RowDefinition Height="Auto"/>
   <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
  <Grid.ColumnDefinitions>
 <ColumnDefinition Width="200"/>
           <ColumnDefinition Width="150"/>
  <ColumnDefinition Width="*"/>
  </Grid.ColumnDefinitions>
       
       <TextBlock Grid.Row="0" Grid.Column="0" Text="Support Spacing:" VerticalAlignment="Center" FontWeight="SemiBold"/>
     <TextBox x:Name="txtSupportSpacing" Grid.Row="0" Grid.Column="1" Height="32" Padding="8" Margin="0,5"
           Text="{Binding DataContext.TubeSupportSpacing, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
  <TextBlock Grid.Row="0" Grid.Column="2" Text="feet" VerticalAlignment="Center" Margin="10,0" Foreground="{StaticResource SecondaryText}"/>
  
  <TextBlock Grid.Row="1" Grid.Column="0" Text="Support Quantity:" VerticalAlignment="Center" FontWeight="SemiBold"/>
       <TextBox x:Name="txtSupportQuantity" Grid.Row="1" Grid.Column="1" Height="32" Padding="8" Margin="0,5"
     Text="{Binding DataContext.TubeSupportQuantity, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
         <TextBlock Grid.Row="1" Grid.Column="2" Text="supports" VerticalAlignment="Center" Margin="10,0" Foreground="{StaticResource SecondaryText}"/>
      
   <TextBlock Grid.Row="2" Grid.Column="0" Text="Support Size:" VerticalAlignment="Center" FontWeight="SemiBold"/>
      <ComboBox x:Name="cmbSupportSize" Grid.Row="2" Grid.Column="1" Height="32" Margin="0,5"
     SelectedItem="{Binding DataContext.TubeSupportSize, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay}">
       <ComboBoxItem Content="C3x4.1"/>
 <ComboBoxItem Content="C3x5"/>
    <ComboBoxItem Content="C4x5.4"/>
    <ComboBoxItem Content="C4x7.25"/>
      </ComboBox>
 </Grid>
     </Border>
  </Expander>

            <!-- Vertical Pitches Section -->
         <Expander x:Name="expVerticalPitches" Header="VERTICAL PITCHES (ADVANCED)" IsExpanded="False" 
      Margin="0,0,0,15" BorderBrush="#607D8B" BorderThickness="2">
         <Expander.HeaderTemplate>
   <DataTemplate>
    <TextBlock Text="{Binding}" FontSize="14" FontWeight="Bold" Foreground="#455A64" Margin="5"/>
       </DataTemplate>
   </Expander.HeaderTemplate>
            <Border Style="{StaticResource SectionBorder}">
       <Grid>
  <Grid.ColumnDefinitions>
   <ColumnDefinition Width="*"/>
 <ColumnDefinition Width="20"/>
  <ColumnDefinition Width="*"/>
     </Grid.ColumnDefinitions>
       
<!-- Front Pitches -->
       <StackPanel Grid.Column="0">
        <TextBlock Text="Front Header Vertical Pitches" FontWeight="Bold" Margin="0,0,0,10" Foreground="#1976D2"/>
     <Grid>
    <Grid.ColumnDefinitions>
          <ColumnDefinition Width="100"/>
     <ColumnDefinition Width="*"/>
      </Grid.ColumnDefinitions>
  <Grid.RowDefinitions>
   <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
     <RowDefinition Height="Auto"/>
       <RowDefinition Height="Auto"/>
  <RowDefinition Height="Auto"/>
     <RowDefinition Height="Auto"/>
    <RowDefinition Height="Auto"/>
    <RowDefinition Height="Auto"/>
     </Grid.RowDefinitions>
  
      <TextBlock Grid.Row="0" Grid.Column="0" Text="Pitch 1-2:" VerticalAlignment="Center"/>
       <TextBox x:Name="txtFrontPitch12" Grid.Row="0" Grid.Column="1" Height="28" Padding="5" Margin="0,3"
          Text="{Binding DataContext.FrontPitch12, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
        <TextBlock Grid.Row="1" Grid.Column="0" Text="Pitch 2-3:" VerticalAlignment="Center"/>
          <TextBox x:Name="txtFrontPitch23" Grid.Row="1" Grid.Column="1" Height="28" Padding="5" Margin="0,3"
    Text="{Binding DataContext.FrontPitch23, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
       <TextBlock Grid.Row="2" Grid.Column="0" Text="Pitch 3-4:" VerticalAlignment="Center"/>
       <TextBox x:Name="txtFrontPitch34" Grid.Row="2" Grid.Column="1" Height="28" Padding="5" Margin="0,3"
  Text="{Binding DataContext.FrontPitch34, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
  <TextBlock Grid.Row="3" Grid.Column="0" Text="Pitch 4-5:" VerticalAlignment="Center"/>
   <TextBox x:Name="txtFrontPitch45" Grid.Row="3" Grid.Column="1" Height="28" Padding="5" Margin="0,3"
             Text="{Binding DataContext.FrontPitch45, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
  <TextBlock Grid.Row="4" Grid.Column="0" Text="Pitch 5-6:" VerticalAlignment="Center"/>
    <TextBox x:Name="txtFrontPitch56" Grid.Row="4" Grid.Column="1" Height="28" Padding="5" Margin="0,3"
     Text="{Binding DataContext.FrontPitch56, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
    <TextBlock Grid.Row="5" Grid.Column="0" Text="Pitch 6-7:" VerticalAlignment="Center"/>
    <TextBox x:Name="txtFrontPitch67" Grid.Row="5" Grid.Column="1" Height="28" Padding="5" Margin="0,3"
  Text="{Binding DataContext.FrontPitch67, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
   <TextBlock Grid.Row="6" Grid.Column="0" Text="Pitch 7-8:" VerticalAlignment="Center"/>
      <TextBox x:Name="txtFrontPitch78" Grid.Row="6" Grid.Column="1" Height="28" Padding="5" Margin="0,3"
     Text="{Binding DataContext.FrontPitch78, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
   <TextBlock Grid.Row="7" Grid.Column="0" Text="Pitch 8-9:" VerticalAlignment="Center"/>
   <TextBox x:Name="txtFrontPitch89" Grid.Row="7" Grid.Column="1" Height="28" Padding="5" Margin="0,3"
          Text="{Binding DataContext.FrontPitch89, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
        <TextBlock Grid.Row="8" Grid.Column="0" Text="Pitch 9-10:" VerticalAlignment="Center"/>
<TextBox x:Name="txtFrontPitch910" Grid.Row="8" Grid.Column="1" Height="28" Padding="5" Margin="0,3"
    Text="{Binding DataContext.FrontPitch910, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
        </Grid>
  </StackPanel>
       
 <!-- Rear Pitches -->
       <StackPanel Grid.Column="2">
    <TextBlock Text="Rear Header Vertical Pitches" FontWeight="Bold" Margin="0,0,0,10" Foreground="#1976D2"/>
   <Grid>
      <Grid.ColumnDefinitions>
  <ColumnDefinition Width="100"/>
        <ColumnDefinition Width="*"/>
   </Grid.ColumnDefinitions>
     <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
           <RowDefinition Height="Auto"/>
       <RowDefinition Height="Auto"/>
    <RowDefinition Height="Auto"/>
    <RowDefinition Height="Auto"/>
    <RowDefinition Height="Auto"/>
  <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>
   
   <TextBlock Grid.Row="0" Grid.Column="0" Text="Pitch 1-2:" VerticalAlignment="Center"/>
   <TextBox x:Name="txtRearPitch12" Grid.Row="0" Grid.Column="1" Height="28" Padding="5" Margin="0,3"
 Text="{Binding DataContext.RearPitch12, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
 <TextBlock Grid.Row="1" Grid.Column="0" Text="Pitch 2-3:" VerticalAlignment="Center"/>
         <TextBox x:Name="txtRearPitch23" Grid.Row="1" Grid.Column="1" Height="28" Padding="5" Margin="0,3"
   Text="{Binding DataContext.RearPitch23, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
      <TextBlock Grid.Row="2" Grid.Column="0" Text="Pitch 3-4:" VerticalAlignment="Center"/>
  <TextBox x:Name="txtRearPitch34" Grid.Row="2" Grid.Column="1" Height="28" Padding="5" Margin="0,3"
    Text="{Binding DataContext.RearPitch34, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
    <TextBlock Grid.Row="3" Grid.Column="0" Text="Pitch 4-5:" VerticalAlignment="Center"/>
  <TextBox x:Name="txtRearPitch45" Grid.Row="3" Grid.Column="1" Height="28" Padding="5" Margin="0,3"
   Text="{Binding DataContext.RearPitch45, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
      <TextBlock Grid.Row="4" Grid.Column="0" Text="Pitch 5-6:" VerticalAlignment="Center"/>
 <TextBox x:Name="txtRearPitch56" Grid.Row="4" Grid.Column="1" Height="28" Padding="5" Margin="0,3"
Text="{Binding DataContext.RearPitch56, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
     <TextBlock Grid.Row="5" Grid.Column="0" Text="Pitch 6-7:" VerticalAlignment="Center"/>
         <TextBox x:Name="txtRearPitch67" Grid.Row="5" Grid.Column="1" Height="28" Padding="5" Margin="0,3"
         Text="{Binding DataContext.RearPitch67, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
   <TextBlock Grid.Row="6" Grid.Column="0" Text="Pitch 7-8:" VerticalAlignment="Center"/>
     <TextBox x:Name="txtRearPitch78" Grid.Row="6" Grid.Column="1" Height="28" Padding="5" Margin="0,3"
        Text="{Binding DataContext.RearPitch78, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
    <TextBlock Grid.Row="7" Grid.Column="0" Text="Pitch 8-9:" VerticalAlignment="Center"/>
<TextBox x:Name="txtRearPitch89" Grid.Row="7" Grid.Column="1" Height="28" Padding="5" Margin="0,3"
      Text="{Binding DataContext.RearPitch89, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
<TextBlock Grid.Row="8" Grid.Column="0" Text="Pitch 9-10:" VerticalAlignment="Center"/>
         <TextBox x:Name="txtRearPitch910" Grid.Row="8" Grid.Column="1" Height="28" Padding="5" Margin="0,3"
    Text="{Binding DataContext.RearPitch910, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
   </Grid>
  </StackPanel>
     </Grid>
    </Border>
   </Expander>

            <!-- Structure & Plenum Section -->
     <Expander x:Name="expStructure" Header="STRUCTURE AND PLENUM" IsExpanded="False" 
       Margin="0,0,0,15" BorderBrush="#795548" BorderThickness="2">
     <Expander.HeaderTemplate>
 <DataTemplate>
    <TextBlock Text="{Binding}" FontSize="14" FontWeight="Bold" Foreground="#5D4037" Margin="5"/>
          </DataTemplate>
          </Expander.HeaderTemplate>
            <Border Style="{StaticResource SectionBorder}">
             <Grid>
     <Grid.RowDefinitions>
           <RowDefinition Height="Auto"/>
         <RowDefinition Height="Auto"/>
 <RowDefinition Height="Auto"/>
<RowDefinition Height="Auto"/>
    <RowDefinition Height="Auto"/>
        <RowDefinition Height="Auto"/>
   <RowDefinition Height="Auto"/>
   <RowDefinition Height="Auto"/>
       </Grid.RowDefinitions>
 <Grid.ColumnDefinitions>
   <ColumnDefinition Width="200"/>
      <ColumnDefinition Width="150"/>
   <ColumnDefinition Width="*"/>
   </Grid.ColumnDefinitions>

    <TextBlock Grid.Row="0" Grid.Column="0" Text="Fan Count:" VerticalAlignment="Center" FontWeight="SemiBold"/>
    <TextBox x:Name="txtFanCount" Grid.Row="0" Grid.Column="1" Height="32" Padding="8" Margin="0,5"
Text="{Binding DataContext.FanCount, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
     
     <TextBlock Grid.Row="1" Grid.Column="0" Text="Plenum Length:" VerticalAlignment="Center" FontWeight="SemiBold"/>
  <TextBox x:Name="txtPlenumLength" Grid.Row="1" Grid.Column="1" Height="32" Padding="8" Margin="0,5"
   Text="{Binding DataContext.PlenumLength, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
           <TextBlock Grid.Row="1" Grid.Column="2" Text="inches" VerticalAlignment="Center" Margin="10,0" Foreground="{StaticResource SecondaryText}"/>
         
  <TextBlock Grid.Row="2" Grid.Column="0" Text="Offset from Center:" VerticalAlignment="Center" FontWeight="SemiBold"/>
 <TextBox x:Name="txtOffsetCenter" Grid.Row="2" Grid.Column="1" Height="32" Padding="8" Margin="0,5"
       Text="{Binding DataContext.OffsetFromCenter, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
  <TextBlock Grid.Row="2" Grid.Column="2" Text="inches" VerticalAlignment="Center" Margin="10,0" Foreground="{StaticResource SecondaryText}"/>
  
 <TextBlock Grid.Row="3" Grid.Column="0" Text="Plenum Style:" VerticalAlignment="Center" FontWeight="SemiBold"/>
       <ComboBox x:Name="cmbPlenumStyle" Grid.Row="3" Grid.Column="1" Height="32" Margin="0,5"
   SelectedItem="{Binding DataContext.PlenumStyle, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay}">
    <ComboBoxItem Content="Standard"/>
        <ComboBoxItem Content="Johnson"/>
   <ComboBoxItem Content="Legacy"/>
       </ComboBox>
 
      <TextBlock Grid.Row="4" Grid.Column="0" Text="Column Size:" VerticalAlignment="Center" FontWeight="SemiBold"/>
 <ComboBox x:Name="cmbColumnSize" Grid.Row="4" Grid.Column="1" Height="32" Margin="0,5"
SelectedItem="{Binding DataContext.ColumnSize, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay}">
    <ComboBoxItem Content="W6x15"/>
        <ComboBoxItem Content="W6x20"/>
 <ComboBoxItem Content="W8x18"/>
      </ComboBox>
     
    <TextBlock Grid.Row="5" Grid.Column="0" Text="Unit Weight:" VerticalAlignment="Center" FontWeight="SemiBold"/>
 <TextBox x:Name="txtWeight" Grid.Row="5" Grid.Column="1" Height="32" Padding="8" Margin="0,5"
         Text="{Binding DataContext.Weight, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
    <TextBlock Grid.Row="5" Grid.Column="2" Text="lbs" VerticalAlignment="Center" Margin="10,0" Foreground="{StaticResource SecondaryText}"/>

   <TextBlock Grid.Row="6" Grid.Column="0" Text="Lug Stagger:" VerticalAlignment="Center" FontWeight="SemiBold"/>
      <TextBox x:Name="txtLugStagger" Grid.Row="6" Grid.Column="1" Height="32" Padding="8" Margin="0,5"
    Text="{Binding DataContext.LugStagger, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
      
     <TextBlock Grid.Row="7" Grid.Column="0" Text="Lug Spacing:" VerticalAlignment="Center" FontWeight="SemiBold"/>
   <TextBox x:Name="txtLugSpacing" Grid.Row="7" Grid.Column="1" Height="32" Padding="8" Margin="0,5"
  Text="{Binding DataContext.LugSpacing, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
       </Grid>
       </Border>
     </Expander>

    <!-- Advanced Options Section -->
  <Expander x:Name="expAdvanced" Header="ADVANCED OPTIONS" IsExpanded="False" 
       Margin="0,0,0,15" BorderBrush="#9E9E9E" BorderThickness="2">
   <Expander.HeaderTemplate>
   <DataTemplate>
  <TextBlock Text="{Binding}" FontSize="14" FontWeight="Bold" Foreground="#616161" Margin="5"/>
      </DataTemplate>
        </Expander.HeaderTemplate>
            <Border Style="{StaticResource SectionBorder}">
   <StackPanel>
  <CheckBox x:Name="chkCamber" Content="Enable Camber" Margin="0,5" FontSize="13" FontWeight="SemiBold"
       IsChecked="{Binding DataContext.EnableCamber, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay}"/>
    <CheckBox x:Name="chkCreateDrawing" Content="Create Drawing Automatically" Margin="0,5" FontSize="13" FontWeight="SemiBold"
  IsChecked="{Binding DataContext.CreateDrawing, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay}"/>
      <CheckBox x:Name="chkSaveFiles" Content="Save Files After Generation" Margin="0,5" FontSize="13" FontWeight="SemiBold"
       IsChecked="{Binding DataContext.SaveFiles, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay}"/>
       <CheckBox x:Name="chkDeleteTemp" Content="Delete Temporary Files" Margin="0,5" FontSize="13" FontWeight="SemiBold"
 IsChecked="{Binding DataContext.DeleteTemp, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay}"/>
    
        <Separator Margin="0,15"/>
       
   <TextBlock Text="Purchase Order Information" FontWeight="Bold" Margin="0,0,0,10" Foreground="#1976D2"/>
        <Grid>
     <Grid.ColumnDefinitions>
        <ColumnDefinition Width="150"/>
      <ColumnDefinition Width="*"/>
 </Grid.ColumnDefinitions>
      <Grid.RowDefinitions>
    <RowDefinition Height="Auto"/>
  <RowDefinition Height="Auto"/>
   </Grid.RowDefinitions>
    
       <TextBlock Grid.Row="0" Grid.Column="0" Text="Purchase Order:" VerticalAlignment="Center"/>
    <TextBox x:Name="txtPurchaseOrder" Grid.Row="0" Grid.Column="1" Height="32" Padding="8" Margin="0,5"
Text="{Binding DataContext.PurchaseOrder, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
   
   <TextBlock Grid.Row="1" Grid.Column="0" Text="Item Number:" VerticalAlignment="Center"/>
 <TextBox x:Name="txtItemNumber" Grid.Row="1" Grid.Column="1" Height="32" Padding="8" Margin="0,5"
       Text="{Binding DataContext.ItemNumber, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
     </Grid>
    </StackPanel>
                </Border>
      </Expander>

     <!-- Summary/Calculated Values -->
        <Border BorderBrush="{StaticResource SuccessColor}" BorderThickness="2" CornerRadius="8" Padding="20" Margin="0,0,0,20">
  <Border.Background>
        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
      <GradientStop Color="#E8F5E9" Offset="0.0"/>
  <GradientStop Color="#C8E6C9" Offset="1.0"/>
         </LinearGradientBrush>
    </Border.Background>
         <StackPanel>
 <TextBlock Text="ðŸ“Š Calculated Summary" FontSize="16" FontWeight="Bold" 
   Foreground="#2E7D32" Margin="0,0,0,15"/>
   <Grid>
         <Grid.ColumnDefinitions>
    <ColumnDefinition Width="*"/>
         <ColumnDefinition Width="*"/>
       <ColumnDefinition Width="*"/>
     </Grid.ColumnDefinitions>
        
         <StackPanel Grid.Column="0">
     <TextBlock Text="Total Tubes" FontSize="11" Foreground="{StaticResource SecondaryText}"/>
      <TextBlock x:Name="txtCalcTubes" FontSize="24" FontWeight="Bold" Foreground="#4CAF50"
             Text="{Binding DataContext.CalculatedTubes, RelativeSource={RelativeSource AncestorType=Window}, Mode=OneWay}"/>
    </StackPanel>
    
   <StackPanel Grid.Column="1">
       <TextBlock Text="Bundle Height" FontSize="11" Foreground="{StaticResource SecondaryText}"/>
             <TextBlock x:Name="txtCalcHeight" FontSize="24" FontWeight="Bold" Foreground="#4CAF50"
Text="{Binding DataContext.CalculatedHeight, RelativeSource={RelativeSource AncestorType=Window}, Mode=OneWay, StringFormat={}{0:F2} in}"/>
         </StackPanel>

      <StackPanel Grid.Column="2">
  <TextBlock Text="Weight" FontSize="11" Foreground="{StaticResource SecondaryText}"/>
      <TextBlock x:Name="txtCalcWeight" FontSize="24" FontWeight="Bold" Foreground="#4CAF50"
   Text="{Binding DataContext.CalculatedWeight, RelativeSource={RelativeSource AncestorType=Window}, Mode=OneWay, StringFormat={}{0:N0} lbs}"/>
          </StackPanel>
         </Grid>
     </StackPanel>
   </Border>

     </StackPanel>
    </ScrollViewer>
</UserControl>
