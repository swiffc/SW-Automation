<Window x:Class="UnifiedUI.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="SolidWorks Automation Suite v4.0 - Unified UI" 
        Height="900" Width="1400"
        MinHeight="800" MinWidth="1200"
        WindowStartupLocation="CenterScreen">

    <Window.Resources>
        <!-- Styles -->
        <Style x:Key="HeaderStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Margin" Value="0,10,0,5"/>
        </Style>

        <Style x:Key="SectionStyle" TargetType="GroupBox">
            <Setter Property="Margin" Value="5"/>
            <Setter Property="Padding" Value="10"/>
            <Setter Property="BorderBrush" Value="#CCCCCC"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>

        <Style x:Key="ValidInputStyle" TargetType="TextBox">
            <Setter Property="BorderBrush" Value="Green"/>
            <Setter Property="BorderThickness" Value="2"/>
        </Style>

        <Style x:Key="InvalidInputStyle" TargetType="TextBox">
            <Setter Property="BorderBrush" Value="Red"/>
            <Setter Property="BorderThickness" Value="2"/>
        </Style>
    </Window.Resources>

    <DockPanel>
        <!-- Menu Bar -->
        <Menu DockPanel.Dock="Top">
            <MenuItem Header="File">
                <MenuItem Header="New" Click="NewButton_Click" InputGestureText="Ctrl+N"/>
                <MenuItem Header="Open..." InputGestureText="Ctrl+O"/>
                <MenuItem Header="Save" Click="SaveButton_Click" InputGestureText="Ctrl+S"/>
                <MenuItem Header="Save As..." InputGestureText="Ctrl+Shift+S"/>
                <Separator/>
                <MenuItem Header="Import Excel..." Click="ImportButton_Click"/>
                <MenuItem Header="Export to Excel..." Click="ExportButton_Click"/>
                <Separator/>
                <MenuItem Header="Exit" InputGestureText="Alt+F4"/>
            </MenuItem>
            <MenuItem Header="Edit">
                <MenuItem Header="Undo" InputGestureText="Ctrl+Z"/>
                <MenuItem Header="Redo" InputGestureText="Ctrl+Y"/>
                <Separator/>
                <MenuItem Header="Clear Configuration"/>
            </MenuItem>
            <MenuItem Header="View">
                <MenuItem Header="Show Preview Panel" IsCheckable="True" IsChecked="True"/>
                <MenuItem Header="Show Validation Panel" IsCheckable="True" IsChecked="True"/>
                <MenuItem Header="Show Advanced Options" IsCheckable="True"/>
            </MenuItem>
            <MenuItem Header="Tools">
                <MenuItem Header="Job Browser..."/>
                <MenuItem Header="Standards Library..."/>
                <MenuItem Header="Template Manager..."/>
                <Separator/>
                <MenuItem Header="Options..."/>
            </MenuItem>
            <MenuItem Header="Templates">
                <MenuItem Header="Save as Template..."/>
                <MenuItem Header="Load Template..."/>
                <MenuItem Header="Manage Templates..."/>
            </MenuItem>
            <MenuItem Header="Help">
                <MenuItem Header="Documentation"/>
                <MenuItem Header="Video Tutorials"/>
                <MenuItem Header="About..."/>
            </MenuItem>
        </Menu>

        <!-- Toolbar -->
        <ToolBar DockPanel.Dock="Top" Height="40">
            <Button Name="NewButton" Click="NewButton_Click" ToolTip="New Configuration">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="📂" FontSize="16" Margin="0,0,5,0"/>
                    <TextBlock Text="New"/>
                </StackPanel>
            </Button>
            <Button Name="SaveButton" Click="SaveButton_Click" ToolTip="Save Configuration">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="💾" FontSize="16" Margin="0,0,5,0"/>
                    <TextBlock Text="Save"/>
                </StackPanel>
            </Button>
            <Separator/>
            <Button Name="ImportButton" Click="ImportButton_Click" ToolTip="Import from Excel">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="📥" FontSize="16" Margin="0,0,5,0"/>
                    <TextBlock Text="Import"/>
                </StackPanel>
            </Button>
            <Button Name="ExportButton" Click="ExportButton_Click" ToolTip="Export to Excel">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="📤" FontSize="16" Margin="0,0,5,0"/>
                    <TextBlock Text="Export"/>
                </StackPanel>
            </Button>
            <Separator/>
            <TextBlock Text="Template:" VerticalAlignment="Center" Margin="5,0"/>
            <ComboBox Name="TemplateComboBox" Width="200" 
                      SelectionChanged="TemplateComboBox_SelectionChanged"
                      ItemsSource="{Binding Templates}"
                      DisplayMemberPath="Name"/>
            <Separator/>
            <TextBlock Text="🔍" FontSize="16" VerticalAlignment="Center" Margin="10,0,5,0"/>
            <TextBox Name="SearchBox" Width="200" 
                     TextChanged="SearchBox_TextChanged"
                     ToolTip="Search parameters"/>
        </ToolBar>

        <!-- Status Bar -->
        <StatusBar DockPanel.Dock="Bottom" Height="30">
            <StatusBarItem>
                <TextBlock Text="{Binding StatusMessage}"/>
            </StatusBarItem>
            <Separator/>
            <StatusBarItem>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="Validation: "/>
                    <TextBlock Text="{Binding ValidationStatus}" FontWeight="Bold"/>
                </StackPanel>
            </StatusBarItem>
        </StatusBar>

        <!-- Bottom Action Bar -->
        <Border DockPanel.Dock="Bottom" BorderBrush="#CCCCCC" BorderThickness="0,1,0,0" Padding="10" Background="#F5F5F5">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Validation Summary -->
                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="{Binding ValidationIcon}" FontSize="20" Margin="0,0,10,0"/>
                    <TextBlock Text="{Binding ValidationSummary}" FontSize="14" VerticalAlignment="Center"/>
                </StackPanel>

                <!-- Action Buttons -->
                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <Button Content="⚙️ Advanced" Width="100" Height="35" Margin="5"/>
                    <Button Content="📋 Summary" Width="100" Height="35" Margin="5"/>
                    <Button Name="GenerateButton" Content="⚡ Generate" Width="120" Height="35" 
                            Margin="5" Click="GenerateButton_Click"
                            Background="#4CAF50" Foreground="White" FontWeight="Bold"/>
                    <Button Content="💾 Save" Width="100" Height="35" Margin="5" Click="SaveButton_Click"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Main Content Area -->
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="3*"/>
                <ColumnDefinition Width="5"/>
                <ColumnDefinition Width="2*"/>
            </Grid.ColumnDefinitions>

            <!-- Left Panel: Configuration -->
            <ScrollViewer Grid.Column="0" VerticalScrollBarVisibility="Auto">
                <StackPanel Margin="10">
                    <!-- Component Type Tabs -->
                    <TextBlock Text="Component Type" Style="{StaticResource HeaderStyle}"/>
                    <TabControl Name="ComponentTabs" Height="700">
                        <!-- Tab items will be added dynamically in code-behind -->
                    </TabControl>
                </StackPanel>
            </ScrollViewer>

            <!-- Splitter -->
            <GridSplitter Grid.Column="1" Width="5" HorizontalAlignment="Stretch" Background="#CCCCCC"/>

            <!-- Right Panel: Preview and Validation -->
            <Grid Grid.Column="2">
                <Grid.RowDefinitions>
                    <RowDefinition Height="2*"/>
                    <RowDefinition Height="5"/>
                    <RowDefinition Height="1*"/>
                </Grid.RowDefinitions>

                <!-- Preview Panel -->
                <Border Grid.Row="0" BorderBrush="#CCCCCC" BorderThickness="1" Margin="10">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0" Text="👁️ Live Preview" 
                                   Style="{StaticResource HeaderStyle}" Margin="10"/>

                        <Border Grid.Row="1" Background="#F9F9F9" Margin="10">
                            <Viewbox>
                                <Canvas Name="PreviewCanvas" Width="300" Height="300">
                                    <TextBlock Canvas.Left="100" Canvas.Top="140" 
                                               Text="3D Preview" FontSize="16" Foreground="#999"/>
                                </Canvas>
                            </Viewbox>
                        </Border>

                        <StackPanel Grid.Row="2" Margin="10">
                            <TextBlock Text="Dimensions:" FontWeight="Bold" Margin="0,0,0,5"/>
                            <TextBlock Text="{Binding PreviewDimensions}"/>
                            <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                                <Button Content="🔄 Rotate" Width="70" Margin="2"/>
                                <Button Content="🔍 Zoom" Width="70" Margin="2"/>
                                <Button Content="↔️ Pan" Width="70" Margin="2"/>
                                <Button Content="🏠 Reset" Width="70" Margin="2"/>
                            </StackPanel>
                        </StackPanel>
                    </Grid>
                </Border>

                <GridSplitter Grid.Row="1" Height="5" HorizontalAlignment="Stretch" Background="#CCCCCC"/>

                <!-- Validation Panel -->
                <Border Grid.Row="2" BorderBrush="#CCCCCC" BorderThickness="1" Margin="10">
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <StackPanel Margin="10">
                            <TextBlock Text="✅ Validation Status" Style="{StaticResource HeaderStyle}"/>
                            
                            <StackPanel Orientation="Horizontal" Margin="0,5">
                                <TextBlock Text="✓" Foreground="Green" FontWeight="Bold" Margin="0,0,5,0"/>
                                <TextBlock Text="{Binding ValidParameterCount}"/>
                                <TextBlock Text=" Parameters Valid"/>
                            </StackPanel>

                            <StackPanel Orientation="Horizontal" Margin="0,5">
                                <TextBlock Text="⚠" Foreground="Orange" FontWeight="Bold" Margin="0,0,5,0"/>
                                <TextBlock Text="{Binding WarningCount}"/>
                                <TextBlock Text=" Warnings"/>
                            </StackPanel>

                            <StackPanel Orientation="Horizontal" Margin="0,5">
                                <TextBlock Text="✗" Foreground="Red" FontWeight="Bold" Margin="0,0,5,0"/>
                                <TextBlock Text="{Binding ErrorCount}"/>
                                <TextBlock Text=" Errors"/>
                            </StackPanel>

                            <Separator Margin="0,10"/>

                            <ItemsControl ItemsSource="{Binding ValidationMessages}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding}" TextWrapping="Wrap" Margin="0,2"/>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </StackPanel>
                    </ScrollViewer>
                </Border>
            </Grid>
        </Grid>
    </DockPanel>
</Window>
